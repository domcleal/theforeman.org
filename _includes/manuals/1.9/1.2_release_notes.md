## Release notes for {{page.version}}

### Headline features

#### Web UI enhancements

Foreman 1.9 adds a few small quality-of-life enhancements to the user interface.  Click any of the video links for a short, 30-second demo.

New dropdown menus are now used throughout the application, which allow you to quickly filter and search for available entries on every field.

* [YouTube video: dropdown menus](https://www.youtube.com/watch?v=E2PSCFsa9yM)

Parameters with large amounts of text, such as JSON or YAML, have been hard to edit before now as the text boxes are usually quite small.  A new button has been added next to them to instantly open a full-screen editor, just like template editing.

* [YouTube video: full-screen parameter editing](https://www.youtube.com/watch?v=ETzNfGTqc00)

Large fact values were truncated before, so SSH public keys and other long pieces of data couldn't be copied out of Foreman.  A new link next to each fact now shows the full value.

* [YouTube video: copying fact values](https://www.youtube.com/watch?v=EQVakzL49rQ)

Partition tables are now a type of provisioning template, enabling the same editing, auditing and revision control that templates have available.

#### Enhanced logging

Logging in the Foreman application has been overhauled, with more granular logs and new configuration directives to control which type of messages are logged.

Using /etc/foreman/settings.yaml, the log level can now easily be changed (e.g. to debug) or specific types of logs enabled.  See [Configuration Options](/manuals/1.9/index.html#3.5.2ConfigurationOptions) and [Debugging](/manuals/1.9/index.html#7.2Debugging) for more information.

#### Image provisioning with Libvirt

When provisioning from images with Libvirt (KVM), Foreman only supported SSH-based provisioning by running a finish against the running VM with predetermined credentials.  With Foreman 1.9, support for cloud-init has been added, using a cloud-init disk.

To enable, set up a user_data template associated to the operating system and enable "user data" on the image under the compute resource.  The template will be added to a temporary disk attached to the VM for cloud-init to consume on boot.

#### New email notifications

Administrators can now subscribe to a summary email of audit events, which track any changes by users to stored records (e.g. hosts) in Foreman.

Users building hosts can now subscribe to a notification when a host build completes, which is sent to the host's owner(s).

See [Email Management](/manuals/1.9/index.html#4.6EmailManagement) for more information on changing notification settings.

### Release notes for 1.9.0

#### API
* Add vm_compute_attributes API call to retrieve compute attributes for a host ([#10720](http://projects.theforeman.org/issues/10720))
* Add template_combinations API calls beneath host groups and environments ([#9031](http://projects.theforeman.org/issues/9031))
* Add FOREMAN_APIPIE_LANGS languages override for development environments ([#10815](http://projects.theforeman.org/issues/10815))
* Change unversioned API access from version 1 to version 2 ([#10167](http://projects.theforeman.org/issues/10167))
* Change build_pxe_default API call method to POST from GET ([#6976](http://projects.theforeman.org/issues/6976))
* Accept lowercase BMC provider names in host interfaces API ([#10382](http://projects.theforeman.org/issues/10382))
* Fix validation and requirement for override_values to have a match and value ([#9812](http://projects.theforeman.org/issues/9812))
* Fix build_pxe_default API call to return JSON response ([#10715](http://projects.theforeman.org/issues/10715))
* Fix fact_values API call with a non-admin user ([#9793](http://projects.theforeman.org/issues/9793))
* Fix compute resource brand names in compute resource documentation ([#9632](http://projects.theforeman.org/issues/9632))

#### Authentication and Authorization
* Add debug logging to authorized resource lookups under `permissions` logger ([#10736](http://projects.theforeman.org/issues/10736))
* Fix authorization check for viewing compute resource VMs ([#10683](http://projects.theforeman.org/issues/10683))
* Fix org/location edit forms to only show authorized resources ([#7337](http://projects.theforeman.org/issues/7337))
* Fix permission for "All users" checkbox to be displayed on org/location edit ([#7335](http://projects.theforeman.org/issues/7335))
* Fix permission names to be globally unique ([#10492](http://projects.theforeman.org/issues/10492))

#### CLI
* Add foreman-debug configuration file ([#10701](http://projects.theforeman.org/issues/10701))
* Change foreman-debug to be non-interactive ([#10284](http://projects.theforeman.org/issues/10284))
* Fix foreman-debug options -u and -a to be exclusive ([#10699](http://projects.theforeman.org/issues/10699))

#### Compute resources and Hosts creation
* Add support for image provisioning on Libvirt with userdata and cloud-init disk ([#10072](http://projects.theforeman.org/issues/10072))
* Add Cisco NX-OS POAP provisioning support ([#10526](http://projects.theforeman.org/issues/10526))
* Change Windows installation media handling to use wimboot ([#9299](http://projects.theforeman.org/issues/9299))
* Update fog to 1.30.0 ([#10261](http://projects.theforeman.org/issues/10261))
* Change websockify proxy port to be randomized within 5910-5930 ([#10703](http://projects.theforeman.org/issues/10703))
* Check presence of and restore DHCP records on host build ([#1536](http://projects.theforeman.org/issues/1536))
* Validate presence of BMC smart proxy when adding managed BMC interface ([#10727](http://projects.theforeman.org/issues/10727))
* Change root password and partition table to optional on hosts not in build mode ([#9993](http://projects.theforeman.org/issues/9993))
* Fix creation of hosts with volumes on Google Compute Engine ([#4551](http://projects.theforeman.org/issues/4551))
* Fix vSphere resource pool retrieval when cluster name and path differ ([#10151](http://projects.theforeman.org/issues/10151))
* Fix configuration of alias interfaces during provisioning ([#10666](http://projects.theforeman.org/issues/10666))
* Fix matching of virtual interfaces on compute resources, only match physicals ([#10664](http://projects.theforeman.org/issues/10664))

#### Installer and packaging
* Improve error message generated by smart proxy registration failure ([#10466](http://projects.theforeman.org/issues/10466))
* Update to scoped_search 3.x ([#8502](http://projects.theforeman.org/issues/8502))

Installer modules have been updated, see their respective changelogs for more detailed notes:

#### Proxy and Services
* Add debug logging to all IPMI calls ([#9709](http://projects.theforeman.org/issues/9709))
* Add API call to test BMC connection to IPMI ([#9710](http://projects.theforeman.org/issues/9710))
* Extend BMC API to show available providers etc. ([#9711](http://projects.theforeman.org/issues/9711))
* Add new startup script for the service under Windows ([#9713](http://projects.theforeman.org/issues/9713))
* Add mechanism to support config file migrations ([#10003](http://projects.theforeman.org/issues/10003))
* Add TFTP and DHCP options support for provisioning Cisco POAP ([#10527](http://projects.theforeman.org/issues/10527))
* Add dhcp_omapi_port setting to change ISC dhcpd OMAPI port ([#10264](http://projects.theforeman.org/issues/10264))
* Add smart proxy project README ([#9121](http://projects.theforeman.org/issues/9121))
* Move smart_proxy_chef request classes to the plugin itself ([#10895](http://projects.theforeman.org/issues/10895))
* Fix missing Windows gem dependencies in bundler ([#10320](http://projects.theforeman.org/issues/10320))
* Fix BMC API to respond with 501 when provider API is not implemented ([#9840](http://projects.theforeman.org/issues/9840))
* Fix parsing of request body in BMC API to pass additional options ([#10116](http://projects.theforeman.org/issues/10116))
* Fix error handler to print stacktrace at debug level ([#10639](http://projects.theforeman.org/issues/10639))
* Fix logging of template proxy operations ([#10769](http://projects.theforeman.org/issues/10769))
* Fix spelling of "nonexistent" in messages ([#10801](http://projects.theforeman.org/issues/10801))
* Fix DNS lookup hang during trusted host tests ([#9919](http://projects.theforeman.org/issues/9919))

#### Puppet and Puppet integration
* Add outofsync_interval setting to control expected out of sync duration of reports ([#10337](http://projects.theforeman.org/issues/10337))
* Change Puppet environment field on hosts to be optional ([#9301](http://projects.theforeman.org/issues/9301))
* Fix association of OS and architecture during facts import ([#10633](http://projects.theforeman.org/issues/10633))
* Prevent validation of default values when a class parameter uses the Puppet default ([#9187](http://projects.theforeman.org/issues/9187))

#### Security
* Disallow users with edit_users permission to change admin user passwords ([CVE-2015-3235](/security.html#2015-3155), [#10829](http://projects.theforeman.org/issues/10829))
* Add audits email summary for a regular report of audit events ([#1213](http://projects.theforeman.org/issues/1213))
* Add host build completion email notification ([#1510](http://projects.theforeman.org/issues/1510))
* Encrypt LDAP auth source passwords when stored at rest in database ([#10263](http://projects.theforeman.org/issues/10263))
* Change default root password hash from MD5 to SHA256 ([#10289](http://projects.theforeman.org/issues/10289))
* Fix SELinux module building on EL7.1 with apache_content_template macro ([#9791](http://projects.theforeman.org/issues/9791))
* Refactor require_ssl code to use Rails force_ssl feature ([#10471](http://projects.theforeman.org/issues/10471))

#### Web Interface
* Add new select box styling to enable searching on every dropdown menu ([#10641](http://projects.theforeman.org/issues/10641))
* Change dashboard to store widgets in the DB and support minimizing ([#8106](http://projects.theforeman.org/issues/8106))
* Add full screen edit button to parameter override text boxes ([#3856](http://projects.theforeman.org/issues/3856))
* Add button to show full fact values for easy copying ([#9194](http://projects.theforeman.org/issues/9194))
* Add axis labels and reposition legends on charts ([#9454](http://projects.theforeman.org/issues/9454))
* Add caps lock warning to password fields ([#8898](http://projects.theforeman.org/issues/8898))
* Rearrange overrides section in smart class parameters and host parameters pages ([#8214](http://projects.theforeman.org/issues/8214), [#8217](http://projects.theforeman.org/issues/8217))
* Rearrange hosts and provisioning menus to follow usual configuration order ([#9334](http://projects.theforeman.org/issues/9334))
* Reorganize setting categories to be more logical ([#8566](http://projects.theforeman.org/issues/8566))
* Fix host delete confirmation box to include hostname and VM deletion warning ([#9879](http://projects.theforeman.org/issues/9879))
* Fix error during second run of orchestration from Discovery ([#9424](http://projects.theforeman.org/issues/9424))
* Fix display of long org/location names in current context ([#8861](http://projects.theforeman.org/issues/8861))
* Fix display of messages on smart proxy errors on Certificates pages ([#9674](http://projects.theforeman.org/issues/9674))
* Fix highlight of error message when Puppet classes are not available in environment ([#10738](http://projects.theforeman.org/issues/10738))
* Fix ambiguity in token_duration setting help text ([#10194](http://projects.theforeman.org/issues/10194))
* Rename "mail" to "email" across the user interface for consistency ([#8525](http://projects.theforeman.org/issues/8525))
* Fix sending of template parameters in form submissions ([#10849](http://projects.theforeman.org/issues/10849))
* Fix activation of second autocomplete field on pages ([#10817](http://projects.theforeman.org/issues/10817))
* Fix quickstart URL in README ([#10518](http://projects.theforeman.org/issues/10518))
* Fix parameter name "spaces" error message to be consistent ([#9439](http://projects.theforeman.org/issues/9439))
* Fix typo in build PXE default confirmation box ([#9806](http://projects.theforeman.org/issues/9806))
* Fix 404 error when selecting Puppet environment on host group form ([#9444](http://projects.theforeman.org/issues/9444))
* Refactor template full screen mode for reusability ([#10638](http://projects.theforeman.org/issues/10638))

#### Various fixes and features
* Add custom logger capabilities and extended logging configuration ([#10487](http://projects.theforeman.org/issues/10487))
* Add debug-level logging of LDAP calls and queries ([#10406](http://projects.theforeman.org/issues/10406))
* Change trends to aggregate and reduce data points ([#10439](http://projects.theforeman.org/issues/10439))
* Change logging of backtraces to regular log levels and remove truncation ([#10713](http://projects.theforeman.org/issues/10713))
* Change Fog library loading to only load providers in active use ([#8516](http://projects.theforeman.org/issues/8516))
* Allow locations and organizations with the same names ([#10660](http://projects.theforeman.org/issues/10660))
* Update documentation for reports expiry rake task ([#10513](http://projects.theforeman.org/issues/10513))
* Allow configuration of logging level from settings.yaml ([#6524](http://projects.theforeman.org/issues/6524))
* Fix audit records being created on counter updates ([#10656](http://projects.theforeman.org/issues/10656))
* Fix audit records being created on Puppet class host changes ([#10288](http://projects.theforeman.org/issues/10288))
* Fix slow report fetch SQL query under PostgreSQL on dashboard ([#10879](http://projects.theforeman.org/issues/10879))
* Fix unnecessary SQL queries when orgs/locations are disabled ([#6332](http://projects.theforeman.org/issues/6332))
* Fix N+1 SQL query on host and host group forms ([#9969](http://projects.theforeman.org/issues/9969))
* Fix uniq calls to run in database ([#10583](http://projects.theforeman.org/issues/10583))
* Fix sort.uniq call ordering to improve performance ([#10584](http://projects.theforeman.org/issues/10584))
* Fix accessible host groups to remove unnecessary sorting ([#3016](http://projects.theforeman.org/issues/3016))
* Fix in-memory attribute fetches with more specific database calls ([#9593](http://projects.theforeman.org/issues/9593))
* Fix wrapping of host parameter table headers in Japanese ([#7532](http://projects.theforeman.org/issues/7532))
* Fix unlocalized period in org/locations help page ([#7454](http://projects.theforeman.org/issues/7454))
* Fix formatting of Puppet error email notifications ([#9998](http://projects.theforeman.org/issues/9998))
* Fix foreman_url setting to be mandatory ([#9613](http://projects.theforeman.org/issues/9613))
* Fix validation of unattended_url field to check protocols ([#5649](http://projects.theforeman.org/issues/5649))
* Fix user groups to disallow empty names ([#3711](http://projects.theforeman.org/issues/3711))
* Fix grammatical mistakes in foreman-rake man page ([#10921](http://projects.theforeman.org/issues/10921))
* Fix seeding of org/locations when one already exists ([#10695](http://projects.theforeman.org/issues/10695))
* Fix Ruby deprecation warning in LDAP auth source ([#4769](http://projects.theforeman.org/issues/4769))
* Fix warnings from duplicate keys in hashes ([#10437](http://projects.theforeman.org/issues/10437))
* Fix intermittent database deadlock during integration tests ([#10507](http://projects.theforeman.org/issues/10507))
* Fix running of auth source tests ([#9957](http://projects.theforeman.org/issues/9957))
* Fix password crypt tests when running on OS X ([#9551](http://projects.theforeman.org/issues/9551))

#### Various internal refactorings
* Add test to check trends reduce task idempotency ([#10439](http://projects.theforeman.org/issues/10439))
* Add helper method to check if a smart proxy has a feature ([#10287](http://projects.theforeman.org/issues/10287))
* Add helper factory for host group provisioning ([#10780](http://projects.theforeman.org/issues/10780))
* Change partition tables to be a type of provisioning template ([#7096](http://projects.theforeman.org/issues/7096))
* Refactorings for Rails 4 compatibility ([#10409](http://projects.theforeman.org/issues/10409))
* Refactor link_to confirm option for Rails 4 compatibility ([#7574](http://projects.theforeman.org/issues/7574))
* Refactor boolean conversion logic into common class ([#10402](http://projects.theforeman.org/issues/10402))
* Refactor host managed logic in NIC models ([#10442](http://projects.theforeman.org/issues/10442))
* Refactor host OS access for consistency ([#9397](http://projects.theforeman.org/issues/9397))
* Remove deprecated smart proxy scopes ([#10899](http://projects.theforeman.org/issues/10899))
* Remove unused columns from hosts table ([#10861](http://projects.theforeman.org/issues/10861))
* Remove setting cache clear debug logging ([#10887](http://projects.theforeman.org/issues/10887))

*A full list of changes in 1.9.0 is available via [Redmine](http://projects.theforeman.org/rb/release/35)*

### Deprecations

The following deprecations may affect API users, plugin authors or advanced users.

* GET build_pxe_default API call is deprecated, API users should use POST instead
* Unversioned API access now uses APIv2, APIv1 users should see [section 5.1.6](/manuals/1.9/index.html#5.1.6APIVersioning)
* "Config templates" in the API were renamed to "provisioning templates" - both work in APIv2, but future API versions will only use provisioning templates
* Deprecated `SmartProxy.*_proxies` accessors were removed

### Contributors

We'd like to thank the following people who contributed to the Foreman {{page.version}} release:


As well as all users who helped test releases, report bugs and provide feedback on the project.

